<?xml version="1.0"?>
<clickhouse>
    <!-- 限制线程数，避免创建过多线程 -->
    <!-- 在 profiles 中设置线程限制 -->
    <profiles>
        <default>
            <!-- 每个查询的最大线程数（默认auto，会根据CPU核心数自动设置，可能导致线程过多） -->
            <!-- 设置为4，30并发×4线程=120个查询线程，相比默认值大幅减少 -->
            <max_threads>4</max_threads>
            <!-- 最终阶段查询的最大线程数 -->
            <max_final_threads>2</max_final_threads>
            <!-- 解析阶段的最大线程数 -->
            <max_parsing_threads>2</max_parsing_threads>
        </default>
    </profiles>
</clickhouse>
