<?xml version="1.0"?>
<clickhouse>
    <!-- 限制线程数，避免创建过多线程 -->
    <!-- 在 profiles 中设置线程限制 -->
    <profiles>
        <default>
            <!-- 每个查询的最大线程数：降低到3个 -->
            <max_threads>3</max_threads>
            <!-- 最终阶段查询的最大线程数 -->
            <max_final_threads>2</max_final_threads>
            <!-- 解析阶段的最大线程数 -->
            <max_parsing_threads>2</max_parsing_threads>
            <!-- 限制并发查询数：最多3个 -->
            <max_concurrent_queries_for_user>3</max_concurrent_queries_for_user>
        </default>
    </profiles>
    
    <!-- 全局线程池配置 -->
    <max_thread_pool_size>6</max_thread_pool_size>
    <max_thread_pool_free_size>3</max_thread_pool_free_size>
    
    <!-- 后台任务线程数：降低到2个 -->
    <background_pool_size>2</background_pool_size>
    <background_schedule_pool_size>2</background_schedule_pool_size>
</clickhouse>
